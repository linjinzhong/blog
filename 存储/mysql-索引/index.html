<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"jesonlin.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.13.2","exturl":false,"sidebar":{"position":"left","display":"hide","padding":18,"offset":12},"copycode":{"enable":true,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="索引帮助存储引擎快速获取数据的一种数据结构，形象的说就是索引是数据的目录。">
<meta property="og:type" content="article">
<meta property="og:title" content="mysql-索引">
<meta property="og:url" content="https://jesonlin.com/%E5%AD%98%E5%82%A8/mysql-%E7%B4%A2%E5%BC%95/index.html">
<meta property="og:site_name" content="jesonlin">
<meta property="og:description" content="索引帮助存储引擎快速获取数据的一种数据结构，形象的说就是索引是数据的目录。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://jesonlin.com/%E5%AD%98%E5%82%A8/mysql-%E7%B4%A2%E5%BC%95/B+tree.webp">
<meta property="og:image" content="https://jesonlin.com/%E5%AD%98%E5%82%A8/mysql-%E7%B4%A2%E5%BC%95/explain%E7%BB%93%E6%9E%9C%E7%BB%93%E6%9E%84.webp">
<meta property="og:image" content="https://jesonlin.com/%E5%AD%98%E5%82%A8/mysql-%E7%B4%A2%E5%BC%95/%E6%95%B0%E6%8D%AE%E9%A1%B5.webp">
<meta property="og:image" content="https://jesonlin.com/%E5%AD%98%E5%82%A8/mysql-%E7%B4%A2%E5%BC%95/B+%E6%A0%91.webp">
<meta property="og:image" content="https://jesonlin.com/%E5%AD%98%E5%82%A8/mysql-%E7%B4%A2%E5%BC%95/count%E6%AF%94%E8%BE%83.webp">
<meta property="article:published_time" content="2022-12-08T14:07:30.000Z">
<meta property="article:modified_time" content="2023-05-18T13:14:09.876Z">
<meta property="article:author" content="jesonlin">
<meta property="article:tag" content="mysql">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jesonlin.com/%E5%AD%98%E5%82%A8/mysql-%E7%B4%A2%E5%BC%95/B+tree.webp">


<link rel="canonical" href="https://jesonlin.com/%E5%AD%98%E5%82%A8/mysql-%E7%B4%A2%E5%BC%95/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://jesonlin.com/%E5%AD%98%E5%82%A8/mysql-%E7%B4%A2%E5%BC%95/","path":"存储/mysql-索引/","title":"mysql-索引"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>mysql-索引 | jesonlin</title>
  






  <script async defer data-website-id="" src=""></script>

  <script defer data-domain="" src=""></script>

  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">jesonlin</p>
      <i class="logo-line"></i>
    </a>
      <img class="custom-logo-image" src="/images/qq-image.jpeg" alt="jesonlin">
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-resources"><a href="/resources/" rel="section"><i class="fa fa-download fa-fw"></i>resources</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="nav-number">1.</span> <span class="nav-text">索引的定义</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95%E5%88%86%E7%B1%BB"><span class="nav-number">2.</span> <span class="nav-text">索引分类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#InnoDB%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E7%B4%A2%E5%BC%95%E9%80%89%E6%8B%A9"><span class="nav-number">3.</span> <span class="nav-text">InnoDB存储引擎索引选择</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#B-tree%E7%B4%A2%E5%BC%95"><span class="nav-number">4.</span> <span class="nav-text">B+tree索引</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E9%A1%B5%E8%A7%92%E5%BA%A6%E7%9C%8BB-%E6%A0%91"><span class="nav-number">5.</span> <span class="nav-text">数据页角度看B+树</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88-MySQL-%E9%87%87%E7%94%A8-B-%E6%A0%91%E4%BD%9C%E4%B8%BA%E7%B4%A2%E5%BC%95%EF%BC%9F"><span class="nav-number">6.</span> <span class="nav-text">为什么 MySQL 采用 B+ 树作为索引？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL-%E5%8D%95%E8%A1%A8%E4%B8%8D%E8%A6%81%E8%B6%85%E8%BF%87-2000W-%E8%A1%8C%EF%BC%9F"><span class="nav-number">7.</span> <span class="nav-text">MySQL 单表不要超过 2000W 行？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88%E6%83%85%E5%86%B5"><span class="nav-number">8.</span> <span class="nav-text">索引失效情况</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL-%E4%BD%BF%E7%94%A8-like-%E2%80%9C-x%E2%80%9C%EF%BC%8C%E7%B4%A2%E5%BC%95%E4%B8%80%E5%AE%9A%E4%BC%9A%E5%A4%B1%E6%95%88%E5%90%97%EF%BC%9F"><span class="nav-number">9.</span> <span class="nav-text">MySQL 使用 like “%x“，索引一定会失效吗？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#count-%E5%92%8C-count-1-%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB%EF%BC%9F%E5%93%AA%E4%B8%AA%E6%80%A7%E8%83%BD%E6%9C%80%E5%A5%BD%EF%BC%9F"><span class="nav-number">10.</span> <span class="nav-text">count(*) 和 count(1) 有什么区别？哪个性能最好？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#REFERENCE"><span class="nav-number">11.</span> <span class="nav-text">REFERENCE</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="jesonlin"
      src="/images/handsome.jpg">
  <p class="site-author-name" itemprop="name">jesonlin</p>
  <div class="site-description" itemprop="description">choice is better than effort</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">25</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/linjinzhong" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;linjinzhong" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:jesonlin@outlook.com" title="E-Mail → mailto:jesonlin@outlook.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/jesonlinjz" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;jesonlinjz" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.facebook.com/jesonlinjz" title="FB Page → https:&#x2F;&#x2F;www.facebook.com&#x2F;jesonlinjz" rel="noopener" target="_blank"><i class="fab fa-facebook fa-fw"></i>FB Page</a>
      </span>
  </div>


<!-- CloudCalendar -->
<div class="widget-wrap" style="width: 90%;margin-left: auto;margin-right: auto; opacity: 0.97;">
	<div class="widget" id="CloudCalendar"></div>
</div>
        </div>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">
 

      

  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jesonlin.com/%E5%AD%98%E5%82%A8/mysql-%E7%B4%A2%E5%BC%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/handsome.jpg">
      <meta itemprop="name" content="jesonlin">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="jesonlin">
      <meta itemprop="description" content="choice is better than effort">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="mysql-索引 | jesonlin">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          mysql-索引
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-12-08 22:07:30" itemprop="dateCreated datePublished" datetime="2022-12-08T22:07:30+08:00">2022-12-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-05-18 21:14:09" itemprop="dateModified" datetime="2023-05-18T21:14:09+08:00">2023-05-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AD%98%E5%82%A8/" itemprop="url" rel="index"><span itemprop="name">存储</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>7.3k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>7 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>索引帮助存储引擎快速获取数据的一种数据结构，形象的说就是索引是数据的目录。</p>
<span id="more"></span>

<h2 id="索引的定义"><a href="#索引的定义" class="headerlink" title="索引的定义"></a>索引的定义</h2><p>帮助存储引擎快速获取数据的一种数据结构，形象的说就是索引是数据的目录。</p>
<h2 id="索引分类"><a href="#索引分类" class="headerlink" title="索引分类"></a>索引分类</h2><ol>
<li>数据结构：B+tree索引、hash索引、Full-text索引</li>
<li>物理存储：聚簇索引（主键索引）、非聚簇索引（二级索引、辅助索引）</li>
<li>字段特性：主键索引、唯一索引、普通索引、前缀索引</li>
<li>字段个数：单列索引、联合索引</li>
</ol>
<h2 id="InnoDB存储引擎索引选择"><a href="#InnoDB存储引擎索引选择" class="headerlink" title="InnoDB存储引擎索引选择"></a>InnoDB存储引擎索引选择</h2><ol>
<li>默认使用主键作为聚簇索引的索引建；</li>
<li>没有主键使用第一个不包含NULL值得唯一列作为聚簇索引的索引键；</li>
<li>都没有情况下，默认生成隐式自助id列作为聚簇索引的索引建；</li>
</ol>
<h2 id="B-tree索引"><a href="#B-tree索引" class="headerlink" title="B+tree索引"></a>B+tree索引</h2><ol>
<li><p>B+tree索引结构（图中叶子节点需改为双向列表）</p>
 <img src="./B+tree.webp" width = "50%" height = "50%" alt="B+tree" align=center />
 
<ol>
<li>多叉树，叶子节点才存放数据，非叶子节点只存放索引，每个节点里的数据是按主键顺序存放的。</li>
<li>叶子节点中包括了所有的索引值信息，有两个指针，分别指向下一个叶子节点和上一个叶子节点，双向链表。</li>
<li>主键索引的 B+Tree 的叶子节点存放的是实际数据，二级索引的 B+Tree 的叶子节点存放的是主键值。</li>
<li>在二级索引的 B+Tree 就能查询到结果的过程就叫作「覆盖索引」，也就是只需要查一个 B+Tree 就能找到数据。</li>
</ol>
</li>
<li><p>为什么 MySQL InnoDB 选择 B+tree 作为索引的数据结构？</p>
<ol>
<li><p>B+Tree vs B Tree<br> B+Tree 只在叶子节点存储数据，而 B 树 的非叶子节点也要存储数据，所以 B+Tree 的单个节点的数据量更小，在相同的磁盘 I&#x2F;O 次数下，就能查询更多的节点。</p>
<p> 另外，B+Tree 叶子节点采用的是双链表连接，适合 MySQL 中常见的基于范围的顺序查找，而 B 树无法做到这一点。B树则需要通过中序遍历才能完成查询范围的查找。</p>
</li>
<li><p>B+Tree vs 二叉树<br> 对于有 N 个叶子节点的 B+Tree，其搜索复杂度为O(logdN)，其中 d 表示节点允许的最大子节点个数为 d 个。</p>
<p> 在实际的应用当中， d 值是大于100的，这样就保证了即使数据达到千万级别时，B+Tree 的高度依然维持在 3<del>4 层左右，也就是说一次数据查询操作只需要做 3</del>4 次的磁盘 I&#x2F;O 操作就能查询到目标数据。</p>
<p> 而二叉树的每个父节点的儿子节点个数只能是 2 个，意味着其搜索复杂度为 O(logN)，这已经比 B+Tree 高出不少，因此二叉树检索到目标数据所经历的磁盘 I&#x2F;O 次数要更多。</p>
</li>
<li><p>B+Tree vs Hash<br> Hash 在做等值查询的时候效率贼快，搜索复杂度为 O(1)。</p>
<p> 但是 Hash 表不适合做范围查询，它更适合做等值的查询，这也是 B+Tree 索引要比 Hash 表索引有着更广泛的适用场景的原因。</p>
</li>
</ol>
</li>
<li><p>联合索引的最左匹配原则<br> 按照最左优先的方式进行索引的匹配<br><br> 在遇到范围查询（如 &gt;、&lt;）的时候，就会停止匹配，也就是范围查询的字段可以用到联合索引，但是在范围查询字段的后面的字段无法用到联合索引。注意，对于 &gt;&#x3D;、&lt;&#x3D;、BETWEEN、like 前缀匹配的范围查询，并不会停止匹配。<br><br> 1. a &gt; 1 and b &gt; 2，从 a &gt; 1 开始扫描<br> 2. a &gt;&#x3D; 1 and b &#x3D; 2，从 a &#x3D; 1 and b &#x3D; 2 开始扫描<br> 3. a between 2 and 8 and b &#x3D; 2，从 a &#x3D; 2 and b &#x3D; 2 开始扫描<br> 4. name like ‘j%’ and age &#x3D; 22，从 name &#x3D; ‘j’ and age &#x3D; 22 开始扫描</p>
</li>
<li><p>索引下推<br> 而 MySQL 5.6 引入的索引下推优化（index condition pushdown)， 可以在联合索引遍历过程中，对联合索引中包含的字段先做判断，直接过滤掉不满足条件的记录，减少回表次数。</p>
</li>
<li><p>索引是否需要创建</p>
<ol>
<li>需要<ol>
<li>字段有唯一性限制</li>
<li>经常用于where&#x2F;group&#x2F;order by的字段</li>
</ol>
</li>
<li>不需要<ol>
<li>区分度底，某个值出现率超过30%优化器会忽略索引使用全表扫描</li>
<li>不经常用于where&#x2F;group&#x2F;order by的字段</li>
<li>表数据太少</li>
<li>经常更新的字段</li>
</ol>
</li>
</ol>
</li>
<li><p>索引优化</p>
<ol>
<li>前缀索引优化，减少索引字段大小，增加索引页中存储的索引值</li>
<li>覆盖索引优化，查询的字段在二级索引的叶子节点都能找到，减少回表操作</li>
<li>主键索引最好是自增的，插入是追加操作，不需要重新移动数据。否则需要移动数据，会造成页分裂，还会造成大量内存碎片</li>
<li>索引最好设置NOT NULL，统计复杂且占用物理空间</li>
</ol>
</li>
<li><p>索引失效情况</p>
<ol>
<li>左或者左右模糊匹配的时候，也就是 like %xx 或者 like %xx%这两种方式都会造成索引失效；(例外情况，查询的字段在二级索引叶子节点（主键+二级索引字段）都能找到，直接全扫描二级索引树)</li>
<li>查询条件中对索引列做了计算、函数、类型转换操作；</li>
<li>联合索引要能正确使用需要遵循最左匹配原则，也就是按照最左优先的方式进行索引的匹配，否则就会导致索引失效；</li>
<li>在 WHERE 子句中，如果在 OR 前的条件列是索引列，而在 OR 后的条件列不是索引列，那么索引会失效。</li>
</ol>
</li>
<li><p>explain 查看查询计划</p>
<ol start="0">
<li><p>explain 结果结构</p>
 <img src="./explain结果结构.webp" width = "50%" height = "50%" alt="explain结果结构" align=center />
</li>
<li><p>参数说明<br> a. possible_keys 字段表示可能用到的索引；<br> b. key 字段表示实际用的索引，如果这一项为 NULL，说明没有使用索引；<br> c. key_len 表示索引的长度；<br> d. rows 表示扫描的数据行数。<br> e. type 表示数据扫描类型，我们需要重点看这个。<br> f. extra 额外说明</p>
</li>
<li><p>type 字段参数说明<br> a. All（全表扫描）；<br> b. index（全索引扫描）；<br> c. range（索引范围扫描）；<br> d. ref（非唯一索引扫描）；<br> e. eq_ref（唯一索引扫描）；eq_ref 通常用于多表联查中；<br> f. const（结果只有一条的主键或唯一索引扫描）。const 是与常量进行比较，查询效率会更快；</p>
</li>
</ol>
</li>
</ol>
<h2 id="数据页角度看B-树"><a href="#数据页角度看B-树" class="headerlink" title="数据页角度看B+树"></a>数据页角度看B+树</h2><ol>
<li><p>InnDB 如何存储数据</p>
 <img src="./数据页.webp" width = "50%" height = "50%" alt="数据页" align=center/>

<ol>
<li>InnoDB 的数据是按「数据页」为单位来读写的</li>
<li>InnoDB 数据页的默认大小是 16KB</li>
<li>数据页中的记录按照「主键」顺序组成单向链表，单向链表的特点就是插入、删除非常方便，但是检索效率不高，最差的情况下需要遍历链表上的所有节点才能完成检索</li>
<li>因此，数据页中有一个页目录，起到记录的索引作用</li>
<li>页目录就是由多个槽组成的<br> 槽相当于分组记录的索引，即每组最后一条记录的地址偏移量。我们通过槽查找记录时，可以使用二分法快速定位要查询的记录在哪个槽（哪个记录分组），定位到槽后，再遍历槽内的所有记录，找到对应的记录</li>
<li>槽内的记录数量规定<ol>
<li>第一个分组中的记录只能有 1 条记录；</li>
<li>最后一个分组中的记录条数范围只能在 1-8 条之间；</li>
<li>剩下的分组中记录条数范围只能在 4-8 条之间。</li>
</ol>
</li>
</ol>
</li>
<li><p>B+树如何查询数据</p>
 <img src="./B+树.webp" width = "50%" height = "50%" alt="B+树" align=center/>

<ol>
<li><p>磁盘的 I&#x2F;O 操作次数对索引的使用效率至关重要，“矮胖”的B+树数据结构所需要进行的磁盘 I&#x2F;O 次数更少，而且 B+ 树更适合进行关键字的范围查询。</p>
</li>
<li><p>B+树特点</p>
<ol>
<li>只有叶子节点（最底层的节点）才存放了数据，非叶子节点（其他上层节）仅用来存放目录项作为索引。</li>
<li>非叶子节点分为不同层次，通过分层来降低每一层的搜索量；</li>
<li>所有节点按照索引键大小排序，构成一个双向链表，便于范围查询；</li>
</ol>
</li>
<li><p>聚簇索引和二级索引<br> 因为表的数据都是存放在聚簇索引的叶子节点里，所以 InnoDB 存储引擎一定会为表创建一个聚簇索引，且由于数据在物理上只会保存一份，所以聚簇索引只能有一个。</p>
<p> 如果某个查询语句使用了二级索引，但是查询的数据不是主键值，这时在二级索引找到主键值后，需要去聚簇索引中获得数据行，这个过程就叫作「回表」，也就是说要查两个 B+ 树才能查到数据。不过，当查询的数据是主键值时，因为只在二级索引就能查询到，不用再去聚簇索引查，这个过程就叫作「索引覆盖」，也就是只需要查一个 B+ 树就能找到数据。</p>
</li>
</ol>
</li>
</ol>
<h2 id="为什么-MySQL-采用-B-树作为索引？"><a href="#为什么-MySQL-采用-B-树作为索引？" class="headerlink" title="为什么 MySQL 采用 B+ 树作为索引？"></a>为什么 MySQL 采用 B+ 树作为索引？</h2><p>不单单要从数据结构的角度出发，还要考虑磁盘 I&#x2F;O 操作次数，因为 MySQL 的数据是存储在磁盘中的嘛。</p>
<p>由于数据库的索引是保存到磁盘上的，因此当我们通过索引查找某行数据的时候，就需要先从磁盘读取索引到内存，再通过索引从磁盘中找到某行数据，然后读入到内存，也就是说查询过程中会发生多次磁盘 I&#x2F;O，而磁盘 I&#x2F;O 次数越多，所消耗的时间也就越大。</p>
<ol>
<li><p>怎样的索引数据结构是好的<br> MySQL 的数据是持久化的，意味着数据（索引+记录）是保存到磁盘上的，因为这样即使设备断电了，数据也不会丢失。</p>
<p> 磁盘读写的最小单位是扇区，扇区的大小只有 512B 大小，操作系统一次会读写多个扇区，所以操作系统的最小读写单位是块（Block）。Linux 中的块大小为 4KB，也就是一次磁盘 I&#x2F;O 操作会直接读写 8 个扇区。</p>
<p> 由于数据库的索引是保存到磁盘上的，因此当我们通过索引查找某行数据的时候，就需要先从磁盘读取索引到内存，再通过索引从磁盘中找到某行数据，然后读入到内存，也就是说查询过程中会发生多次磁盘 I&#x2F;O，而磁盘 I&#x2F;O 次数越多，所消耗的时间也就越大。</p>
<p> 所以，要设计一个适合 MySQL 索引的数据结构，至少满足以下要求：</p>
<pre><code> 1. 能在尽可能少的磁盘的 I/O 操作中完成查询工作；
 2. 要能高效地查询某一个记录，也要能高效地执行范围查找；
</code></pre>
</li>
<li><p>B+ 作为索引的数据结构原因</p>
<ol>
<li>B+ 树的非叶子节点不存放实际的记录数据，仅存放索引，因此数据量相同的情况下，相比存储即存索引又存记录的 B 树，B+树的非叶子节点可以存放更多的索引，因此 B+ 树可以比 B 树更「矮胖」，查询底层节点的磁盘 I&#x2F;O次数会更少。</li>
<li>B+ 树有大量的冗余节点（所有非叶子节点都是冗余索引），这些冗余索引让 B+ 树在插入、删除的效率都更高，比如删除根节点的时候，不会像 B 树那样会发生复杂的树的变化；</li>
<li>B+ 树叶子节点之间用链表连接了起来，有利于范围查询，而 B 树要实现范围查询，因此只能通过树的遍历来完成范围查询，这会涉及多个节点的磁盘 I&#x2F;O 操作，范围查询效率不如 B+ 树。</li>
</ol>
</li>
</ol>
<h2 id="MySQL-单表不要超过-2000W-行？"><a href="#MySQL-单表不要超过-2000W-行？" class="headerlink" title="MySQL 单表不要超过 2000W 行？"></a>MySQL 单表不要超过 2000W 行？</h2><ol>
<li><p>假设</p>
<ol>
<li><p>非叶子节点内指向其他页的数量为 x<br> 索引页记录 x &#x3D; (16KB - 1KB) * 1024KB &#x2F; (8B + 4B) ~ 1280 行<br> 索引页记录 x &#x3D; (页大小 - 页头、页号、目录等) * 1024 B &#x2F; (索引行数据&#x3D;索引 + 页号)</p>
</li>
<li><p>叶子节点内能容纳的数据行数为 y<br> 数据页记录 y &#x3D; (16KB - 1KB) * 1KB &#x2F; 1KB ~ 15<br> 数据页记录 y &#x3D; (页大小 - 页头、页号、目录等) * 1024 B &#x2F; (行数据假设1KB)</p>
</li>
<li><p>B+ 数的层数为 z</p>
</li>
<li><p>总记录数 &#x3D; Total &#x3D; x^(z-1) * y</p>
</li>
<li><p>假设 B+ 树是两层<br> z &#x3D; 2， Total &#x3D; （1280 ^1 ）* 15 &#x3D; 19200</p>
</li>
<li><p>假设 B+ 树是三层<br> z &#x3D; 3， Total &#x3D; （1280 ^2） * 15 &#x3D; 24576000 （约 2.45kw）</p>
</li>
<li><p>这正好就是文章开头说的最大行数建议值 2000W。对的，一般 B+ 数的层级最多也就是 3 层。</p>
</li>
</ol>
</li>
<li><p>单行数据变多情况下，建议值减少<br> 我们刚刚在说 Y 的值时候假设的是 1K ，那比如我实际当行的数据占用空间不是 1K , 而是 5K, 那么单个数据页最多只能放下 3 条数据。</p>
<p> 同样，还是按照 z &#x3D; 3 的值来计算，那 Total &#x3D; （1280 ^2） *3 &#x3D; 4915200 （近 500w）</p>
<p> 所以，在保持相同的层级（相似查询性能）的情况下，在行数据大小不同的情况下，其实这个最大建议值也是不同的，而且影响查询性能的还有很多其他因素，比如，数据库版本，服务器配置，sql 的编写等等。</p>
<p> MySQL 为了提高性能，会将表的索引装载到内存中，在 InnoDB buffer size 足够的情况下，其能完成全加载进内存，查询不会有问题。</p>
<p> 但是，当单表数据库到达某个量级的上限时，导致内存无法存储其索引，使得之后的 SQL 查询会产生磁盘 IO，从而导致性能下降，所以增加硬件配置（比如把内存当磁盘使），可能会带来立竿见影的性能提升哈。</p>
</li>
<li><p>总结</p>
<ol>
<li>MySQL 的表数据是以页的形式存放的，页在磁盘中不一定是连续的。</li>
<li>页的空间是 16K, 并不是所有的空间都是用来存放数据的，会有一些固定的信息，如，页头，页尾，页码，校验码等等。</li>
<li>在 B+ 树中，叶子节点和非叶子节点的数据结构是一样的，区别在于，叶子节点存放的是实际的行数据，而非叶子节点存放的是主键和页号。</li>
<li>索引结构不会影响单表最大行数，2000W 也只是推荐值，超过了这个值可能会导致 B + 树层级更高，影响查询性能。更多的与单记录数据大小有关，数据越大，页节点越多，整个树层级就会越高。</li>
</ol>
</li>
</ol>
<h2 id="索引失效情况"><a href="#索引失效情况" class="headerlink" title="索引失效情况"></a>索引失效情况</h2><ol>
<li><p>对索引使用左或者左右模糊匹配<br> 使用左或者左右模糊匹配的时候，也就是 like %xx 或者 like %xx% 都会造成索引失效。</p>
<p> 因为索引 B+ 树是按照「索引值」有序排列存储的，只能根据前缀进行比较。</p>
</li>
<li><p>对索引使用函数<br> 如果查询条件中对索引字段使用函数，就会导致索引失效。</p>
<p> 因为索引保存的是索引字段的原始值，而不是经过函数计算后的值，自然就没办法走索引了。</p>
<p> 从 MySQL 8.0 开始，索引特性增加了函数索引</p>
</li>
<li><p>对索引进行表达式计算<br> 失效： where id + 1 &#x3D; 10;<br> 不失效：where id &#x3D; 10 - 1; </p>
</li>
<li><p>对索引隐式类型转换<br> 失效： phone &#x3D; 1300000001; where CAST(phone AS signed int) &#x3D; 1300000001;<br> 不失效： id &#x3D; ‘1’; where id &#x3D; CAST(“1” AS signed int);</p>
<p> 通过 select “10” &gt; 9 的结果来知道MySQL 的数据类型转换规则是什么：</p>
<p> 自动「字符串」转换成「数字」，就相当于 select 10 &gt; 9，这个就是数字比较，所以结果应该是 1；</p>
<p> 自动「数字」转换成「字符串」，就相当于 select “10” &gt; “9”，所以结果应该是 0。</p>
<p> 说明 MySQL 在遇到字符串和数字比较的时候，会自动把字符串转为数字，然后再进行比较。</p>
</li>
<li><p>联合索引非最左匹配<br> 创建了一个 (a, b, c) 联合索引</p>
<ol>
<li><p>有效（顺序无关，优化器调整）</p>
<ol>
<li>where a&#x3D;1；</li>
<li>where a&#x3D;1 and b&#x3D;2 and c&#x3D;3；</li>
<li>where a&#x3D;1 and b&#x3D;2；</li>
</ol>
</li>
<li><p>无效</p>
<ol>
<li>where b&#x3D;2；</li>
<li>where c&#x3D;3；</li>
<li>where b&#x3D;2 and c&#x3D;3；</li>
</ol>
</li>
<li><p>截断<br> where a &#x3D; 1 and c &#x3D; 3</p>
<p> 只使用前面 a 会走索引</p>
<p> mysql5.5在联合索引找到主键值后，开始回表，到主键索引读取数据行，Server 层从存储引擎层获取到数据行后，然后在 Server 层再比对 c 字段的值。</p>
<p> 从 MySQL 5.6 之后，有一个索引下推功能，可以在存储引擎层进行索引遍历过程中，对索引中包含的字段先做判断，直接过滤掉不满足条件的记录，再返还给 Server 层，从而减少回表次数。</p>
</li>
<li><p>为什么联合索引不遵循最左匹配原则就会失效？<br> 原因是，在联合索引的情况下，数据是按照索引第一列排序，第一列数据相同时才会按照第二列排序。</p>
</li>
<li><p>WHERE 子句中的 OR<br> 在 WHERE 子句中，如果在 OR 前的条件列是索引列，而在 OR 后的条件列不是索引列，那么索引会失效。</p>
</li>
</ol>
</li>
</ol>
<h2 id="MySQL-使用-like-“-x“，索引一定会失效吗？"><a href="#MySQL-使用-like-“-x“，索引一定会失效吗？" class="headerlink" title="MySQL 使用 like “%x“，索引一定会失效吗？"></a>MySQL 使用 like “%x“，索引一定会失效吗？</h2><p>不一定，关键看数据表中的字段。如果数据库表中的字段只有主键+二级索引，那么即使使用了左模糊匹配，也不会走全表扫描（type&#x3D;all），而是走全扫描二级索引树(type&#x3D;index)。</p>
<p>只不过没利用索引树的有序性的特点，没有通过查询比较的方式，快速定位到了数据行。</p>
<h2 id="count-和-count-1-有什么区别？哪个性能最好？"><a href="#count-和-count-1-有什么区别？哪个性能最好？" class="headerlink" title="count(*) 和 count(1) 有什么区别？哪个性能最好？"></a>count(*) 和 count(1) 有什么区别？哪个性能最好？</h2><ol>
<li><p>结论</p>
 <img src="./count比较.webp" width = "50%" height = "50%" alt="count比较" align=center/>
</li>
<li><p>count()是什么<br> 统计符合查询条件的记录中，函数指定的参数不为 NULL 的记录有多少个。</p>
</li>
<li><p>分析</p>
<ol>
<li><p>表里只有主键索引</p>
<ol>
<li>count(字段)：遍历主键索引，判断字段 !&#x3D; NULL，count++</li>
<li>count(主键字段): 遍历主键索引，判断主键字段 !&#x3D; NULL，count++</li>
<li>count(1): 遍历主键索引, count++</li>
<li>count(*) &#x3D;&#x3D; count(0): 遍历主键索引, count++</li>
</ol>
</li>
<li><p>表里有二级索引</p>
<ol>
<li>count(字段)：遍历主键索引，判断字段 !&#x3D; NULL，count++</li>
<li>count(主键字段): 遍历二级索引，判断主键字段 !&#x3D; NULL，count++</li>
<li>count(1): 遍历二级索引，count++</li>
<li>count(*) &#x3D;&#x3D; count(0): 遍历二级索引，count++</li>
</ol>
</li>
</ol>
</li>
<li><p>小结<br> 所以，如果要执行 count(1)、 count(*)、 count(主键字段) 时，尽量在数据表上建立二级索引，这样优化器会自动采用 key_len 最小的二级索引进行扫描，相比于扫描主键索引效率会高一些。</p>
</li>
<li><p>为什么要通过遍历的方式来计数？</p>
<ol>
<li><p>使用 MyISAM 引擎时，执行 count 函数只需要 O(1 )复杂度，这是因为每张 MyISAM 的数据表都有一个 meta 信息有存储了row_count值，由表级锁保证一致性。</p>
</li>
<li><p>InnoDB 存储引擎是支持事务的，同一个时刻的多个查询，由于多版本并发控制（MVCC）的原因，InnoDB 表“应该返回多少行”也是不确定的，所以无法像 MyISAM一样，只维护一个 row_count 变量。</p>
</li>
<li><p>当带上 where 条件语句之后，MyISAM 跟 InnoDB 就没有区别了，它们都需要扫描表来进行记录个数的统计。</p>
</li>
</ol>
</li>
<li><p>如何优化 count(*)？<br> 如果对一张大表经常用 count(*) 来做统计，其实是很不好的。</p>
<ol>
<li><p>第一种，近似值<br> 可以使用 show table status 或者 explain 命令来表进行估算。执行 explain 命令效率是很高的，因为它并不会真正的去查询，下图中的 rows 字段值就是 explain 命令对表 t_order 记录的估算值。</p>
</li>
<li><p>第二种，额外表保存计数值<br> 如果是想精确的获取表的记录总数，我们可以将这个计数值保存到单独的一张计数表中。</p>
<p> 当我们在数据表插入一条记录的同时，将计数表中的计数字段 + 1。也就是说，在新增和删除操作时，我们需要额外维护这个计数表。</p>
</li>
</ol>
</li>
</ol>
<h2 id="REFERENCE"><a href="#REFERENCE" class="headerlink" title="REFERENCE"></a>REFERENCE</h2><p><a target="_blank" rel="noopener" href="https://time.geekbang.org/column/intro/100020801">MySQL实战45讲</a><br><a target="_blank" rel="noopener" href="https://xiaolincoding.com/mysql/">图解MySQL介绍</a></p>

    </div>

    
    
    

    
      <div>
        <div>
    
        <div style="text-align:center;color: #ccc;font-size:24px;">------------->本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>

      </div>
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button>
    赞赏
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechatpay.png" alt="jesonlin 微信">
        <span>微信</span>
      </div>
      <div>
        <img src="/images/alipay.png" alt="jesonlin 支付宝">
        <span>支付宝</span>
      </div>

  </div>
</div>

          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>原作者： </strong>jesonlin
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://jesonlin.com/%E5%AD%98%E5%82%A8/mysql-%E7%B4%A2%E5%BC%95/" title="mysql-索引">https://jesonlin.com/存储/mysql-索引/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/mysql/" rel="tag"># mysql</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/%E5%AD%98%E5%82%A8/mysql-%E5%9F%BA%E7%A1%80/" rel="prev" title="mysql-基础">
                  <i class="fa fa-chevron-left"></i> mysql-基础
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/%E5%AD%98%E5%82%A8/sqlite3/" rel="next" title="sqlite3">
                  sqlite3 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments gitalk-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2022 – 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">jesonlin</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">187k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">2:50</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.5.0/pjax.min.js" integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/pace.js"></script>

  
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




<!-- calendar widget -->

    <script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-calendar/calendar.min.js"></script>
    <script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-calendar/languages.min.js"></script>
    <script>
    $(function() {
        $('#CloudCalendar').aCalendar('zh-CN',
            $.extend(
                '', {
                    single:true,
                    root:'/calendar/'
                }
            )
        );
    });
    </script>

<script src="https://unpkg.com/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>

<script>
var options = {
  bottom: '64px',
  right: 'unset',
  left: '32px',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#100f2c',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: '🌓',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();
</script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"linjinzhong","repo":"blog","client_id":"8548519d63363d8264e2","client_secret":"72867db898357c6f54e568137fb92545663b5c4a","admin_user":"linjinzhong","distraction_free_mode":true,"proxy":"https://strong-caramel-969805.netlify.app/github_access_token","language":"zh-CN","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js","integrity":"sha256-MVK9MGD/XJaGyIghSVrONSnoXoGh3IFxLw0zfvzpxR4="},"path_md5":"86173fdc3d09de2d694ac0073e8f9029"}</script>
<script src="/js/third-party/comments/gitalk.js"></script>

</body>
</html>
